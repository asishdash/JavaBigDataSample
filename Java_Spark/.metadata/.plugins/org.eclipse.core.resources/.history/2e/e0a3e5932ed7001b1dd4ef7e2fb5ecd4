package com.sparkSampleExample.sparkApi;

import org.apache.spark.sql.Dataset;
import org.apache.spark.sql.Row;
import org.apache.spark.sql.SparkSession;

public class JSON_MULTILINE_PARSER_DEMO {
	
	public void parseMultiLineJsonLines(SparkSession spark) {
	   
	 
	    Dataset<Row> df = spark.read().format("json")
	    	.option("multiline", true)
	    	.option("header", "true").option("inferSchema", "true").option("sep", ",").
	        .load("src/main/resources/file/multiline.json");
	        
	    df.show(5, 150);
	    df.printSchema();
	  }
	
	
	public void parseSimpleJsonLines() {
	    SparkSession spark = SparkSession.builder()
	        .appName("JSON Lines to Dataframe")
	        .master("local")
	        .getOrCreate();
	    
	    Dataset<Row> df = spark.read().format("json")
		        .load("src/main/resources/file/simple.json");
	 
	    df.show(5, 150);
	    df.printSchema();
	  }

}
